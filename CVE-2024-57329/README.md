# CVE-2024-57329: Stored Cross-site Scripting (XSS) in HortusFox v3.9

## Information
**Description:** HortusFox v3.9 contains a stored XSS vulnerability in the "Add Plant" function. The name input field does not sanitize or escape user inputs, allowing attackers to inject and execute arbitrary JavaScript payloads. 
**Versions Affected:**  3.9
**Version Fixed:** NULL
**Researcher:** Fatih Tüzün 


## Proof-of-Concept Exploit
### Description
The vulnerability was identified in the "Add Plant" feature of HortusFox during local testing. Specifically, the name input field is vulnerable to stored XSS, allowing attackers to inject JavaScript payloads. When a user later visits the /chat endpoint, the stored payload is executed in the user's browser.

### Usage/Exploitation
Navigate to the "Add Plant" section of the application.
Enter the following payload into the name field:
```
<script>alert(document.cookie);</script>
```
![2024-12-24_02-29](https://github.com/user-attachments/assets/24e86fd5-1acd-45d2-bf38-5d8049a26b24)

Save the entry.
Navigate to the /chat endpoint of the application.
![2024-12-24_02-29_1](https://github.com/user-attachments/assets/f75a4827-bf6d-42c1-89ec-633c6077463e)

The payload is executed, triggering the JavaScript alert.

## References

OWASP Cross-Site Scripting (XSS) Prevention Cheat Sheet
https://owasp.org/www-project-cheat-sheets/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html

CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
https://cwe.mitre.org/data/definitions/79.html

Mozilla Developer Network (MDN): Cross-Site Scripting (XSS)
https://developer.mozilla.org/en-US/docs/Glossary/Cross-site_scripting
